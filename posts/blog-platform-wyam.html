<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Head&#x27;s in the cloud, a Qubit blog">

  <title>Notes from Qubit Inc. - Wyam with Cake Build, Github pages and Azure Pipeline (Windows Server 2019)</title>

  <link rel="canonical" href="https://note.iqubit.xyz/posts/blog-platform-wyam">

      <link type="application/rss+xml" rel="alternate" href="/feed.rss" />
      <link type="application/atom+xml" rel="alternate" href="/feed.atom" />
  
  <meta name="application-name" content="Notes from Qubit Inc." />
  <meta name="msapplication-tooltip" content="Notes from Qubit Inc." />
  <meta name="msapplication-starturl" content="/" />

  <meta property="og:title" content="Notes from Qubit Inc. - Wyam with Cake Build, Github pages and Azure Pipeline (Windows Server 2019)" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://note.iqubit.xyz/posts/blog-platform-wyam" />
  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

  <!-- Bootstrap core CSS -->
  <link href="/vendor/bootstrap/scss/bootstrap.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="/vendor/fontawesome-free/css/brands.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,500,600,700,400italic,700italic' rel='stylesheet' type='text/css' data-no-mirror>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css' data-no-mirror>
  
  <!-- Custom styles for this template -->
  <link href="/scss/clean-blog.css" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/themes/prism.css">

  <!-- Lunr search -->
    <script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pako@2.0.3/dist/pako_inflate.min.js"></script>
    <script src="/search.js"></script>
  
  


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/">Notes from Qubit Inc.</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="/posts">Posts</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/tags">Tags</a>
            </li>
</ul>
        <form class="form-inline my-2 my-lg-0" action="/search" method="GET">
          <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="query">
          <input type="submit" hidden />
        </form>
    </div>
  </div>
</nav>

  <!-- Page Header -->
  <header class="masthead">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="post-heading">
          <h1>
            Wyam with Cake Build, Github pages and Azure Pipeline (Windows Server 2019)
          </h1>
              <div class="meta">Published on Wednesday, 27 November 2019</div>
                <div class="mt-3">
                      <a href="/tags/markdown" class="badge badge-light"> markdown</a>
                      <a href="/tags/statiq" class="badge badge-light"> statiq</a>
                </div>
        </div>
      </div>
    </div>
  </div>
</header>

  <!-- Main Content -->
  <div class="container"> 
    <div class="row">
      <div id="content" class="col-md-12">  
        <p><em>Wyam is deprecated by <a href="https://github.com/statiqdev">statiq</a>.</em></p>
<h2 id="wyam">Wyam</h2>
<p>First, we install wyam install locally using pwsh admin,</p>
<pre><code>choco install wyam -y
</code></pre>
<p>Then, if we don't have dotnet core in path, we do in current shell,</p>
<pre><code>$Env:Path += ';C:\Program Files\dotnet'
</code></pre>
<p>We browse to our source dir and do a build,</p>
<pre><code>dotnet D:\PFiles_x64\Chocolatey\lib\wyam\Wyam.dll help
dotnet D:\PFiles_x64\Chocolatey\lib\wyam\Wyam.dll help preview
dotnet D:\PFiles_x64\Chocolatey\lib\wyam\Wyam.dll build --help
</code></pre>
<h2 id="github-setup-and-local-build">github setup and local build</h2>
<p>Create a new repo. do a clone or (init and add files).</p>
<p>However, <em>we don't create master branch</em>. We only create a branch called <code>source</code>.</p>
<pre><code>git clone https://github.com/atiq-cs/fftsys-site
Rename-Item fftsys-site wyamBlog
pushd wyamBlog
git checkout -b source
git add .gitignore
git commit -m 'add git ignore file'
git push -u origin source
</code></pre>
<p>Let's create the blog,</p>
<pre><code>dotnet D:\PFiles_x64\Chocolatey\lib\wyam\Wyam.dll new -r Blog
dotnet D:\PFiles_x64\Chocolatey\lib\wyam\Wyam.dll build
dotnet D:\PFiles_x64\Chocolatey\lib\wyam\Wyam.dll preview
</code></pre>
<p>After we add required config file, yml file etc we build on next step. After we are satisfied with local build and previous we push them to the repo.</p>
<h2 id="cake-build">Cake Build</h2>
<p>I update package versions in <code>build.cake</code> file,</p>
<pre><code>#tool nuget:?package=Wyam&amp;version=2.2.9
#tool nuget:?package=GitVersion.CommandLine&amp;version=5.1.3
#addin nuget:?package=Cake.Wyam&amp;version=2.2.9
#addin nuget:?package=Cake.Git&amp;version=0.21.0
</code></pre>
<p>For successful build, we need to set the variables properly,</p>
<pre><code>$Env:GITHUB_USERNAME = 'atique'
$Env:GITHUB_USEREMAIL = 'atiq&#64;github.com'
$Env:GITHUB_ACCESS_TOKEN = '123abcdef456'
$Env:CNAME_CONTENT = 'blog.domain.com'
</code></pre>
<p>To generate new token visit <a href="https://github.com/settings/tokens/new">tokens page</a></p>
<p>Get build script for cake,</p>
<pre><code>Invoke-WebRequest https://cakebuild.net/download/bootstrapper/windows -OutFile build.ps1
</code></pre>
<p>We update in <code>config.wyam</code>,</p>
<pre><code>Settings[Keys.Host] = &quot;blog.domain.com&quot;;
</code></pre>
<p>Otherwise we get,</p>
<pre><code>Compiling build script...
Error: One or more errors occurred.
        Expecting state 'Element'.. Encountered 'Text'  with name '', namespace ''.
</code></pre>
<p>Here's example of local build,</p>
<pre><code>$ .\build -Target Build -Verbosity=verbose
Preparing to run build script...
Running build script...
Analyzing build script...
Processing build script...
Installing tools...
Installing addins...
Compiling build script...

========================================
Build
========================================
Executing task: Build
Wyam version 2.2.9

                ,&#64;&#64;&#64;&#64;&#64;&#64;p
              ,&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;g
            z&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;
          g&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;,
        g&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;,
      ,&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;
     ,&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;
     $&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;c
     &#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;B&#64;&#64;&#64;&#64;&#64;&#64;
     &#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;  j&#64;&#64;&#64;&#64;&#64;
     $&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;F  #&#64;&#64;&#64;&#64;`
      $&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;P   g&#64;&#64;&#64;&#64;P
       %&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;     ,g&#64;&#64;&#64;&#64;&#64;P
        3&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;B`
          `%&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;P
             `*%RB&#64;&#64;&#64;&#64;&#64;RRP`
**BUILD**
Loading configuration from file:///D:/Code/wyamBlog/fftsys/config.wyam
Installing NuGet packages
    Installing packages to C:/Users/atiq/.nuget/packages (using global packages folder)
    NuGet packages installed in 250 ms
Loading assemblies
    Assemblies loaded in 194 ms
Cataloging classes
    Classes cataloged in 116 ms
Evaluating configuration script
    Evaluated configuration script in 26 ms
Root path:
    file:///D:/Code/wyamBlog/fftsys
Input path(s):
    file:///C:/Users/atiq/.nuget/packages/Wyam.Blog.CleanBlog.2.2.9/content
    theme
    input
Output path:
    output
Temp path:
    temp
Using  as the JavaScript engine
Cleaning temp path: temp
Cleaned temp directory
Cleaning output path: output
Cleaned output directory
Executing 15 pipelines
    Executing pipeline &quot;Pages&quot; (1/15) with 4 child module(s)
        Executed pipeline &quot;Pages&quot; (1/15) in 502 ms resulting in 1 output document(s)
    Executing pipeline &quot;BlogPosts&quot; (2/15) with 6 child module(s)
        Executed pipeline &quot;BlogPosts&quot; (2/15) in 120 ms resulting in 8 output document(s)
    Executing pipeline &quot;Tags&quot; (3/15) with 4 child module(s)
        Executed pipeline &quot;Tags&quot; (3/15) in 3737 ms resulting in 15 output document(s)
    Executing pipeline &quot;TagIndex&quot; (4/15) with 1 child module(s)
        Executed pipeline &quot;TagIndex&quot; (4/15) in 87 ms resulting in 1 output document(s)
    Executing pipeline &quot;BlogArchive&quot; (5/15) with 1 child module(s)
        Executed pipeline &quot;BlogArchive&quot; (5/15) in 93 ms resulting in 1 output document(s)
    Executing pipeline &quot;Index&quot; (6/15) with 4 child module(s)
        Executed pipeline &quot;Index&quot; (6/15) in 236 ms resulting in 1 output document(s)
    Executing pipeline &quot;Feed&quot; (7/15) with 3 child module(s)
        Executed pipeline &quot;Feed&quot; (7/15) in 151 ms resulting in 2 output document(s)
    Executing pipeline &quot;RenderBlogPosts&quot; (8/15) with 6 child module(s)
        Executed pipeline &quot;RenderBlogPosts&quot; (8/15) in 497 ms resulting in 8 output document(s)
    Executing pipeline &quot;RenderPages&quot; (9/15) with 6 child module(s)
        Executed pipeline &quot;RenderPages&quot; (9/15) in 141 ms resulting in 1 output document(s)
    Executing pipeline &quot;Redirects&quot; (10/15) with 3 child module(s)
        Executed pipeline &quot;Redirects&quot; (10/15) in 15 ms resulting in 0 output document(s)
    Executing pipeline &quot;Less&quot; (11/15) with 3 child module(s)
        Executed pipeline &quot;Less&quot; (11/15) in 8 ms resulting in 0 output document(s)
    Executing pipeline &quot;Sass&quot; (12/15) with 3 child module(s)
        Executed pipeline &quot;Sass&quot; (12/15) in 6 ms resulting in 0 output document(s)
    Executing pipeline &quot;Resources&quot; (13/15) with 1 child module(s)
        Executed pipeline &quot;Resources&quot; (13/15) in 30 ms resulting in 28 output document(s)
    Executing pipeline &quot;ValidateLinks&quot; (14/15) with 1 child module(s)
        Executed pipeline &quot;ValidateLinks&quot; (14/15) in 1 ms resulting in 0 output document(s)
    Executing pipeline &quot;Sitemap&quot; (15/15) with 3 child module(s)
        Executed pipeline &quot;Sitemap&quot; (15/15) in 10 ms resulting in 1 output document(s)
    Executed 15/15 pipelines in 5676 ms
Finished executing task: Build

Task                          Duration
--------------------------------------------------
Build                         00:00:06.8752279
--------------------------------------------------
Total:                        00:00:06.8752279
</code></pre>
<p>Here's example of deployment from local pwsh,</p>
<pre><code>$ .\build.ps1 -Target Deploy
Preparing to run build script...
Running build script...

========================================
Build
========================================
Wyam version 2.2.9

                ,&#64;&#64;&#64;&#64;&#64;&#64;p
              ,&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;g
            z&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;
          g&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;,
        g&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;,
      ,&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;
     ,&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;
     $&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;c
     &#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;B&#64;&#64;&#64;&#64;&#64;&#64;
     &#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;  j&#64;&#64;&#64;&#64;&#64;
     $&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;F  #&#64;&#64;&#64;&#64;`
      $&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;P   g&#64;&#64;&#64;&#64;P
       %&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;     ,g&#64;&#64;&#64;&#64;&#64;P
        3&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;B`
          `%&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;&#64;P
             `*%RB&#64;&#64;&#64;&#64;&#64;RRP`
**BUILD**
Loading configuration from file:///D:/Code/wyamBlog/fftsys/config.wyam
Installing NuGet packages
    Installing packages to C:/Users/atiq/.nuget/packages (using global packages folder)
    NuGet packages installed in 258 ms
Loading assemblies
    Assemblies loaded in 248 ms
Cataloging classes
    Classes cataloged in 117 ms
Evaluating configuration script
    Evaluated configuration script in 5 ms
Root path:
    file:///D:/Code/wyamBlog/fftsys
Input path(s):
    file:///C:/Users/atiq/.nuget/packages/Wyam.Blog.CleanBlog.2.2.9/content
    theme
    input
Output path:
    output
Temp path:
    temp
Using  as the JavaScript engine
Cleaning temp path: temp
Cleaned temp directory
Cleaning output path: output
Cleaned output directory
Executing 15 pipelines
    Executing pipeline &quot;Pages&quot; (1/15) with 4 child module(s)
        Executed pipeline &quot;Pages&quot; (1/15) in 486 ms resulting in 1 output document(s)
    Executing pipeline &quot;BlogPosts&quot; (2/15) with 6 child module(s)
        Executed pipeline &quot;BlogPosts&quot; (2/15) in 67 ms resulting in 8 output document(s)
    Executing pipeline &quot;Tags&quot; (3/15) with 4 child module(s)
        Executed pipeline &quot;Tags&quot; (3/15) in 3617 ms resulting in 15 output document(s)
    Executing pipeline &quot;TagIndex&quot; (4/15) with 1 child module(s)
        Executed pipeline &quot;TagIndex&quot; (4/15) in 74 ms resulting in 1 output document(s)
    Executing pipeline &quot;BlogArchive&quot; (5/15) with 1 child module(s)
        Executed pipeline &quot;BlogArchive&quot; (5/15) in 124 ms resulting in 1 output document(s)
    Executing pipeline &quot;Index&quot; (6/15) with 4 child module(s)
        Executed pipeline &quot;Index&quot; (6/15) in 221 ms resulting in 1 output document(s)
    Executing pipeline &quot;Feed&quot; (7/15) with 3 child module(s)
        Executed pipeline &quot;Feed&quot; (7/15) in 135 ms resulting in 2 output document(s)
    Executing pipeline &quot;RenderBlogPosts&quot; (8/15) with 6 child module(s)
        Executed pipeline &quot;RenderBlogPosts&quot; (8/15) in 411 ms resulting in 8 output document(s)
    Executing pipeline &quot;RenderPages&quot; (9/15) with 6 child module(s)
        Executed pipeline &quot;RenderPages&quot; (9/15) in 48 ms resulting in 1 output document(s)
    Executing pipeline &quot;Redirects&quot; (10/15) with 3 child module(s)
        Executed pipeline &quot;Redirects&quot; (10/15) in 10 ms resulting in 0 output document(s)
    Executing pipeline &quot;Less&quot; (11/15) with 3 child module(s)
        Executed pipeline &quot;Less&quot; (11/15) in 6 ms resulting in 0 output document(s)
    Executing pipeline &quot;Sass&quot; (12/15) with 3 child module(s)
        Executed pipeline &quot;Sass&quot; (12/15) in 8 ms resulting in 0 output document(s)
    Executing pipeline &quot;Resources&quot; (13/15) with 1 child module(s)
        Executed pipeline &quot;Resources&quot; (13/15) in 67 ms resulting in 28 output document(s)
    Executing pipeline &quot;ValidateLinks&quot; (14/15) with 1 child module(s)
        Executed pipeline &quot;ValidateLinks&quot; (14/15) in 3 ms resulting in 0 output document(s)
    Executing pipeline &quot;Sitemap&quot; (15/15) with 3 child module(s)
        Executed pipeline &quot;Sitemap&quot; (15/15) in 23 ms resulting in 1 output document(s)
    Executed 15/15 pipelines in 5343 ms

========================================
CloneMasterBranch
========================================
Cloning master branch into temp directory

========================================
EmptyMasterBranch
========================================
Emptying master branch

========================================
CopyToMasterBranch
========================================
Copying files to master branch

========================================
CommitMasterBranch
========================================
Performing Git commit on master branch

========================================
PushMasterBranch
========================================
Pushing master branch to origin

========================================
Deploy
========================================

Task                          Duration
--------------------------------------------------
Build                         00:00:06.4142491
CloneMasterBranch             00:00:04.9115101
EmptyMasterBranch             00:00:00.0460689
CopyToMasterBranch            00:00:00.7293069
CommitMasterBranch            00:00:02.1444625
PushMasterBranch              00:00:04.0557769
--------------------------------------------------
Total:                        00:00:18.3127486
</code></pre>
<h2 id="azure-pipelines">Azure Pipelines</h2>
<p>Surf <a href="https://github.com/marketplace/azure-pipelines">azure-pipelines</a> and choose free plan.
<code>azure-pipelines.yml</code> is the pipeline file that triggers the deployment. Additionally, I upgrade it to use the latest VM,</p>
<pre><code>pool:
  vmImage: 'windows-2019'
</code></pre>
<p>However, this one can be tricky to find the right <code>cake-build</code> package in azure. For convenience, here's the one that works: <a href="https://marketplace.visualstudio.com/acquisition?itemName=cake-build.cake">cake build pacakage in marketplacevisualstudio </a></p>
<p>Without this package, pipeline build doesn't succeed and encounters following error,</p>
<pre><code>A task is missing. The pipeline references a task called 'cake-build.cake.cake-build-task.Cake'. This usually indicates the task isn't installed, and you may be able to install it from the Marketplace: https://marketplace.visualstudio.com. (Task version 0, job 'Job', step ''.)
</code></pre>
<p>The call flow looks like following,</p>
<pre><code>Deploy
-&gt; PushMasterBranch
-&gt; CommitMasterBranch
  -&gt; CopyToMasterBranch
  -&gt; Build, EmptyMasterBranch
</code></pre>
<p>To make wyam work, the first one in references section helped a lot.</p>
<h2 id="setting-up-a-custom-domain">Setting up a custom domain</h2>
<p>References for setting up custom domain:</p>
<ul>
<li><a href="https://github.blog/2018-05-01-github-pages-custom-domains-https">Parker Moore - Custom domains on GitHub Pages gain support for HTTPS</a></li>
<li><a href="https://gohugo.io/hosting-and-deployment/hosting-on-github/#use-a-custom-domain">Host on GitHub - Use a Custom Domain</a></li>
<li><a href="https://help.github.com/en/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site">github - Managing a custom domain for your GitHub Pages site</a></li>
</ul>
<p>I my case I set it up on subdomain, <code>blog.fftsysx.com</code></p>
<p>Additionally, I enable DNSSEC for my primary domain which is not required in your case:</p>
<ul>
<li><a href="https://ph.godaddy.com/help/add-a-ds-record-23865">godaddy - dnssec add record</a></li>
<li><a href="https://www.iana.org/assignments/ds-rr-types/ds-rr-types.xhtml">numeric representation for digest type</a></li>
<li><a href="https://blog.cloudflare.com/secure-and-fast-github-pages-with-cloudflare/">trick to enabling https</a> (even though github not allowing)</li>
</ul>
<h3 id="generating-cname-file-for-the-blog">Generating CNAME file for the blog</h3>
<p>I find the section in deployment where files are being generated,</p>
<pre><code>Task(&quot;CopyToMasterBranch&quot;)
    .IsDependentOn(&quot;Build&quot;)
    .IsDependentOn(&quot;EmptyMasterBranch&quot;)
    .Does(() =&gt; {
        var sourcePath = &quot;./output&quot;;

        Information(&quot;Copying files to master branch&quot;);

        // Now Create all of the directories
        foreach (string dirPath in System.IO.Directory.GetDirectories(sourcePath, &quot;*&quot;, SearchOption.AllDirectories))
        {
            System.IO.Directory.CreateDirectory(dirPath.Replace(sourcePath, tempDir));
        }

        // Copy all the files &amp; Replaces any files with the same name
        foreach (string newPath in System.IO.Directory.GetFiles(sourcePath, &quot;*.*&quot;, SearchOption.AllDirectories))
            System.IO.File.Copy(newPath, newPath.Replace(sourcePath, tempDir), true);
    });
</code></pre>
<p>To explain the code segment above,</p>
<ul>
<li>sourcePath = the current output dir from wyam</li>
<li>tempDir = windows temp dir</li>
<li><code>newPath.Replace(sourcePath, tempDir)</code> = tempDir + relative Path of the file</li>
</ul>
<p>File.Copy ref,</p>
<pre><code>public static void Copy (string sourceFileName, string destFileName);
</code></pre>
<p>After last copy in the code semgent above we add this to add CNAME,</p>
<p>We can write the CName in following way,</p>
<pre><code>string CNameContent = &quot;blog.domain.com&quot;;
System.IO.File.WriteAllText(System.IO.Path.Combine(tempDir, CNameFileName), CNameContent);
</code></pre>
<h2 id="pipeline-variables">Pipeline Variables</h2>
<p>Probably these variables reset after we do deploy as below,</p>
<pre><code>.\build -Target Deploy
</code></pre>
<p><a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/process/variables">MS Docs - Pipeline Variables</a></p>
<p>To edit pipeline variables on azure cloud.</p>
<ol>
<li>Naviagate to your pipeline URL.</li>
<li>Click Edit and noow you can access variables</li>
</ol>
<h4 id="conclusion">Conclusion</h4>
<p>wyam uses markdig flavor of Markdown of by default: <a href="https://github.com/lunet-io/markdig/blob/master/src/Markdig.Tests/Specs/MathSpecs.md">markdig math</a></p>
<p>Readily, I can think of following cons,</p>
<ul>
<li>mathematics/latex notation is not working by default</li>
</ul>
<h3 id="references">References</h3>
<p>Usueful refs are below,</p>
<ul>
<li>primary ref: <a href="https://johanvergeer.github.io/posts/wyam-azure-devops">Johan Vergeer - Wyam, Azure DevOps and GitHub Pages</a></li>
<li><a href="https://jonathanhiggs.github.io/posts/create-github-pages-with-wyam">Jonathan Higgs - Create GitHub Pages Blog with Wyam</a></li>
<li><a href="https://wyam.io/docs">wyam official documentation</a></li>
<li><a href="https://daveaglick.com/posts/converting-my-blog-to-wyam">daveaglick - Converting My Blog to Wyam</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/agents/hosted?view=azure-devops">MS Azure Cloud - availabe VMs</a></li>
<li><a href="https://github.com/daveaglick/daveaglick">github daveaglick</a></li>
</ul>



<div id="giscus_thread">
        <script src="https://giscus.app/client.js"
                data-repo="atiq-cs/note"
                data-repo-id="R_kgDOGMJt-w"
                data-category="Announcements"
                data-category-id="DIC_kwDOGMJt-84B_XUr"
                data-mapping="pathname"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-theme="dark"
                crossorigin="anonymous"
                async>
        </script>
</div>

<!-- Google Analytics tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S42PTR68ME"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-S42PTR68ME');
</script>

<noscript>Please enable JavaScript to view the comments powered by giscus, to enable google anlaytics.</noscript>
      </div>
    </div>
  </div>

  <hr>

  <!-- Footer -->  
  <footer>
    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted m-0">Copyright &#xA9; 2022</p>
                    <br />
                    <ul class="list-inline text-center small">
                            <li class="list-inline-item">
                                <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
                            </li>
                            <li class="list-inline-item">
                                <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                            </li>
                    </ul>
                    <br />
                    <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
                </div>
        </div>
    </div>
</footer>

  <!-- Bootstrap core JavaScript -->
  <script src="/vendor/jquery/jquery.min.js"></script>
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  


  

  <!-- Custom scripts for this template -->
  <script src="/js/clean-blog.js"></script>

</body>

</html>
