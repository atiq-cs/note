<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Head&#x27;s in the cloud, a Qubit blog">

  <title>Notes from Qubit Inc. - Useful Windows Commands</title>

  <link rel="canonical" href="https://note.iqubit.xyz/posts/shells/win-command-shell">

      <link type="application/rss+xml" rel="alternate" href="/feed.rss" />
      <link type="application/atom+xml" rel="alternate" href="/feed.atom" />
  
  <meta name="application-name" content="Notes from Qubit Inc." />
  <meta name="msapplication-tooltip" content="Notes from Qubit Inc." />
  <meta name="msapplication-starturl" content="/" />

  <meta property="og:title" content="Notes from Qubit Inc. - Useful Windows Commands" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://note.iqubit.xyz/posts/shells/win-command-shell" />
  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

  <!-- Bootstrap core CSS -->
  <link href="/vendor/bootstrap/scss/bootstrap.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="/vendor/fontawesome-free/css/brands.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,500,600,700,400italic,700italic' rel='stylesheet' type='text/css' data-no-mirror>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css' data-no-mirror>
  
  <!-- Custom styles for this template -->
  <link href="/scss/clean-blog.css" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/themes/prism.css">

  <!-- Lunr search -->
    <script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pako@2.0.3/dist/pako_inflate.min.js"></script>
    <script src="/search.js"></script>
  
  


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/">Notes from Qubit Inc.</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="/posts">Posts</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/tags">Tags</a>
            </li>
</ul>
        <form class="form-inline my-2 my-lg-0" action="/search" method="GET">
          <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="query">
          <input type="submit" hidden />
        </form>
    </div>
  </div>
</nav>

  <!-- Page Header -->
  <header class="masthead">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="post-heading">
          <h1>
            Useful Windows Commands
          </h1>
              <div class="meta">Published on Tuesday, 19 November 2019</div>
                <div class="mt-3">
                      <a href="/tags/windows-command-shell" class="badge badge-light"> windows command shell</a>
                      <a href="/tags/system-administration" class="badge badge-light"> system administration</a>
                </div>
        </div>
      </div>
    </div>
  </div>
</header>

  <!-- Main Content -->
  <div class="container"> 
    <div class="row">
      <div id="content" class="col-md-12">  
        <p><em>Please be aware of notation below in command outlines. <code>$</code> represents a command and rests of the lines following that line are output. The tradition is to utilize the &quot;&gt; &quot; prompt for Windows Command Shell, however, I come from a Unix background and I defy that.</em></p>
<p>Primary ref, <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands#command-line-shells">MSFT Win Server - Intro to Windows Command Line Shell</a></p>
<h4 id="control-panel-commands">Control Panel Commands</h4>
<p>These can be run from Run Command Dialog Box as well,</p>
<pre><code>desk.cpl
services.msc
sysdm.cpl
</code></pre>
<p>Few more,</p>
<pre><code>Name         Description
----         -----------
appwiz.cpl   Shell Application Manager
bthprops.cpl Bluetooth Control Panel Applet
desk.cpl     Desktop Settings Control Panel
Firewall.cpl Windows Defender Firewall Control Panel DLL Launching Stub
hdwwiz.cpl   Add Hardware Control Panel Applet
inetcpl.cpl  Internet Control Panel
intl.cpl     Control Panel DLL
irprops.cpl  Infrared Control Panel Applet
joy.cpl      Game Controllers Control Panel Applet
main.cpl     Mouse and Keyboard Control Panel Applets
mmsys.cpl    Audio Control Panel
ncpa.cpl     Network Connections Control-Panel Stub
powercfg.cpl Power Management Configuration Control Panel Applet
sapi.cpl     Speech UX Control Panel
sysdm.cpl    System Applet for the Control Panel
TabletPC.cpl Tablet PC Control Panel
telephon.cpl Telephony Control Panel
timedate.cpl Time Date Control Panel Applet
wscui.cpl    Security and Maintenance
</code></pre>
<h2 id="misc">Misc</h2>
<p>Customized ping command, waits 20 seconds for reply and keep pinging non-stop <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/ping">ping ref</a>,</p>
<pre><code>ping -w 20000 -t myserver.company.com
</code></pre>
<p>Enable or disable Linux Subsystem feature,</p>
<pre><code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
Disable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
</code></pre>
<p>Get host name,</p>
<pre><code>HOSTNAME
</code></pre>
<p>associating file type for extension <code>.fob</code>,</p>
<pre><code>cmd /c assoc .fob=foobarfile
cmd /c ftype foobarfile=powershell.exe -File `&quot;C:\path\to\your.ps1`&quot; `&quot;%1`&quot;
</code></pre>
<p>Find files with hidden attributes,</p>
<pre><code>dir /A:H general-solving\lintcode
</code></pre>
<p>Modify files to remove hidden attributes using attrib</p>
<pre><code>attrib -h my-hidden-file.txt
</code></pre>
<p><strong>Robust copy</strong></p>
<p>robocopy is quite useful on recovery mode / troubleshooting on UEFI recovery image,</p>
<pre><code>robocopy /zb /s SOURCE DEST
</code></pre>
<p>ref, <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/robocopy">MSFT Learn - Windows Server Commands</a></p>
<p><code>robocopy</code> is good for copying large numbeer of files (to handle so many different cases: large files, network interruptions, file names). An example cmd,</p>
<pre><code>robocopy /s /z /v /fp /eta 'D:\Movies' 'H:\' Office.*
robocopy /s /z /v /fp /eta 'D:\TV Series' 'H:\' Fringe*
</code></pre>
<p>Above cmds copy all files from first one (source dir) matching the pattern.</p>
<p>Exmple of copy over network,</p>
<pre><code>robocopy /s /z /v /fp /eta '\\ENLIGHTENSOUL\Bangla\3RD Person Singular Number' 'i:\'
</code></pre>
<p><strong>xcopy examples</strong></p>
<p><code>xcopy</code> cmd examples,</p>
<pre><code>xcopy /C /F /H e:\c O:
xcopy /s /C /F /H e:\C++ O:\C++
xcopy /s /C /F /H &quot;e:\FC back up&quot; &quot;o:\FC back up&quot;
xcopy /s /C /F /H &quot;e:\Net Workspace&quot; &quot;o:\Net Workspace&quot;
xcopy /s /C /F /H f:\* Q:\*
</code></pre>
<p>I prefer <code>robocopy</code> over <code>xcopy</code>.</p>
<h3 id="file-system-management">File System Management</h3>
<p>Removing directory: delete everything inside a directory,</p>
<pre><code>rd /s /q JobDetails_data
</code></pre>
<p><strong>mklink</strong></p>
<p>To create a symbolic link named MyDocs from the root directory to the \Users\User1\Documents directory,</p>
<pre><code>mklink /d \MyDocs \Users\User1\Documents
</code></pre>
<p>Creates a Directory Junction instead using mklink,</p>
<pre><code>$ mklink /j C:\Users\Atique\AppData\Local\Microsoft\Office\15.0\OfficeFileCache H:\OfficeFileCache
Junction created for C:\Users\Atique\AppData\Local\Microsoft\Office\15.0\OfficeFileCache &lt;&lt;===&gt;&gt; H:\OfficeFileCache
</code></pre>
<p><strong>Network share commands</strong></p>
<p>view curently shared directories,</p>
<pre><code>net share
</code></pre>
<p>to delete share (requires admin privilege),</p>
<pre><code>$ net share NewDrama /delete
Movies      D:\Cool Movies
Softs       D:\Sourcecodes\Web\Softs
</code></pre>
<p>To share a directory,</p>
<pre><code>net share listshare=&quot;D:\Docs&quot;
</code></pre>
<p><strong>registry</strong></p>
<p>For example usage <code>regsvr32</code> of check <a href="https://www.codeproject.com/Articles/766246/Windows-Media-Player-Native-Subtitle-Plugin-Cplusp">codeproject - Windows Media Player Native Subtitle Plugin</a></p>
<p><strong>dos features</strong></p>
<p>Retrieving all cmd history,</p>
<pre><code>doskey /history &gt; copy_command.txt
</code></pre>
<h2 id="references">References</h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/commands-by-server-role">MS Docs - Windows Commands</a></li>
</ul>
<p><em>Powershell is supersedes of command shell. Hence, all commands for this also run on powershell with some minor variations.</em></p>



<div id="giscus_thread">
        <script src="https://giscus.app/client.js"
                data-repo="atiq-cs/note"
                data-repo-id="R_kgDOGMJt-w"
                data-category="Announcements"
                data-category-id="DIC_kwDOGMJt-84B_XUr"
                data-mapping="pathname"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-theme="dark"
                crossorigin="anonymous"
                async>
        </script>
</div>

<!-- Google Analytics tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S42PTR68ME"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-S42PTR68ME');
</script>

<noscript>Please enable JavaScript to view the comments powered by giscus, to enable google anlaytics.</noscript>
      </div>
    </div>
  </div>

  <hr>

  <!-- Footer -->  
  <footer>
    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted m-0">Copyright &#xA9; 2022</p>
                    <br />
                    <ul class="list-inline text-center small">
                            <li class="list-inline-item">
                                <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
                            </li>
                            <li class="list-inline-item">
                                <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                            </li>
                    </ul>
                    <br />
                    <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
                </div>
        </div>
    </div>
</footer>

  <!-- Bootstrap core JavaScript -->
  <script src="/vendor/jquery/jquery.min.js"></script>
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  


  

  <!-- Custom scripts for this template -->
  <script src="/js/clean-blog.js"></script>

</body>

</html>
